<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>dubbo | 小不牛</title><meta name="keywords" content="blog"><meta name="author" content="小不牛"><meta name="copyright" content="小不牛"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="分布式系统中相关概念大型互联网架构目标 高性能：提供快速的访问体验。  高可用：网站服务一直可以正常访问。  可伸缩：通过硬件增加&#x2F;减少，提高&#x2F;降低处理能力。  高可扩展：系统间耦合低，方便的通过新增&#x2F;移除方式，增加&#x2F;减少新的功能&#x2F;模块。  安全性：提供网站安全访问和数据加密，安全存储等策略。  敏捷性：随需应变，快速响应。 传统项目和互联网项目">
<meta property="og:type" content="article">
<meta property="og:title" content="dubbo">
<meta property="og:url" content="http://example.com/2022/03/09/dubbo/dubbo/index.html">
<meta property="og:site_name" content="小不牛">
<meta property="og:description" content="分布式系统中相关概念大型互联网架构目标 高性能：提供快速的访问体验。  高可用：网站服务一直可以正常访问。  可伸缩：通过硬件增加&#x2F;减少，提高&#x2F;降低处理能力。  高可扩展：系统间耦合低，方便的通过新增&#x2F;移除方式，增加&#x2F;减少新的功能&#x2F;模块。  安全性：提供网站安全访问和数据加密，安全存储等策略。  敏捷性：随需应变，快速响应。 传统项目和互联网项目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/dubbo.png">
<meta property="article:published_time" content="2022-03-09T04:07:15.232Z">
<meta property="article:modified_time" content="2022-03-11T06:53:01.543Z">
<meta property="article:author" content="小不牛">
<meta property="article:tag" content="blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/dubbo.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/03/09/dubbo/dubbo/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'dubbo',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-11 14:53:01'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章总览</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小不牛</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章总览</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">dubbo</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-09T04:07:15.232Z" title="发表于 2022-03-09 12:07:15">2022-03-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-11T06:53:01.543Z" title="更新于 2022-03-11 14:53:01">2022-03-11</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="dubbo"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="分布式系统中相关概念"><a href="#分布式系统中相关概念" class="headerlink" title="分布式系统中相关概念"></a>分布式系统中相关概念</h1><h2 id="大型互联网架构目标"><a href="#大型互联网架构目标" class="headerlink" title="大型互联网架构目标"></a>大型互联网架构目标</h2><ul>
<li><p>高性能：提供快速的访问体验。</p>
</li>
<li><p>高可用：网站服务一直可以正常访问。</p>
</li>
<li><p>可伸缩：通过硬件增加&#x2F;减少，提高&#x2F;降低处理能力。</p>
</li>
<li><p>高可扩展：系统间耦合低，方便的通过新增&#x2F;移除方式，增加&#x2F;减少新的功能&#x2F;模块。</p>
</li>
<li><p>安全性：提供网站安全访问和数据加密，安全存储等策略。</p>
</li>
<li><p>敏捷性：随需应变，快速响应。</p>
<h3 id="传统项目和互联网项目"><a href="#传统项目和互联网项目" class="headerlink" title="传统项目和互联网项目"></a>传统项目和互联网项目</h3><p><img src="/./img/traItem.png" alt="传统项目和互联网项目"></p>
</li>
<li><p style="color:#ff0000">衡量一个网站是否快：</p>
<p style="text-indent: 2em;">打开一个新页面一瞬间；页面内跳转，一刹那间完成。</p>
</li>
<li><p>衡量网站的性能诣标：</p>
</li>
<li><p>响应时间：指执行一个请求从开始到最后收到响应数据所花费的总体时间。</p>
</li>
<li><p>并发数：指系统同时能处理的请求数量。</p>
<p style="text-indent: 2em;">并发连接数：指的是客户端向服务器发起请求，并建立了TCP连接。每秒钟服务器连接的总TCP数量。</p>
<p style="text-indent: 2em;">请求数：也称为QPS（Query Per Second）指每秒多少请求。</p>
<p style="text-indent: 2em;">并发用户数：单位时间内有多少用户</p>
</li>
<li><p>吞吐量：指单位时间内系统能处理的请求数量。</p>
<p style="text-indent: 2em;">QPS:Query Per Second每秒查询数。</p>
<p style="text-indent: 2em;">TPS:Transactions Per Second每秒事务数。</p>
<p style="text-indent: 2em;">一个事务是指一个客户机向服务器发送请求然后服务器做出反应的过程。客户机在发送请求时开始计时，收到服务器响应后结束计时，以此来计算使用的时间和完成的事务个数。一个事务是指一个客户机向服务器发送请求然后服务器做出反应的过程。客户机在发送请求时开始计时，收到服务器响应后结束计时，以此来计算使用的时间和完成的事务个数。</p>
<p style="text-indent: 2em;">一个页面的一次访问，只会形成一个TPS；但一次页面请求，可能产生多次对服务器的请求，就会有多个QPS。</p></li>
</ul>
<p style="text-indent: 5em; color:#ff0000">QPS>=并发连接数>=TPS</p>



<h3 id="集群和分布式"><a href="#集群和分布式" class="headerlink" title="集群和分布式"></a>集群和分布式</h3><ol>
<li>集群：很多“人”一起，干一样的事。</li>
<li>分布式：很多“人”一起，干不一样的事。这些不一样的事，合起来是一件大事。<br><img src="/./img/collection.png" alt="集群和分布式示例图"><br><img src="/./img/qiqunAndFengbushi.png" alt="集群和分布式"></li>
</ol>
<h3 id="架构和演进"><a href="#架构和演进" class="headerlink" title="架构和演进"></a>架构和演进</h3><ol>
<li>架构演进–单体架构</li>
</ol>
<ul>
<li><p>优点:</p>
<p style="text-indent: 1em;">简单开发部署很方便，小型项目首选</p>
</li>
<li><p>缺点:</p>
<p style="text-indent: 1em;">项目启动慢</p>
<p style="text-indent: 1em;">可靠性差</p>
<p style="text-indent: 1em;">可伸缩性差</p></li>
</ul>
<ol start="2">
<li>架构演进–垂直架构<br><img src="/./img/verticalFramework.png" alt="垂直架构"></li>
</ol>
<ul>
<li><p>垂直架构是指将单体架构中的多个模块拆分为多个独立的项目。形成格个独立的单体架构。</p>
</li>
<li><p>单体架构存在的问题：</p>
<p style="text-indent: 1em;">目启动慢可靠性差可伸缩性差</p>
<p style="text-indent: 1em;">扩展性和可维护性差</p>
<p style="text-indent: 1em;">性能低</p>
</li>
<li><p>垂直架构存在的问题：</p>
<p style="text-indent: 1em;">重复功能太多</p></li>
</ul>
<ol start="3">
<li>架构演进–分布式架构<br><img src="/./img/distributedFramwork.png" alt="分布式架构"></li>
</ol>
<ul>
<li><p>分布式架构是指在垂直架构的基础上，将公共业务模块抽取出来，作为独立的服务，供其他调用者消费，以实现服务的共享和重用。</p>
</li>
<li><p>RPC:Remote Procedure Call远程过程调用。有非常多的协议和技术来都实现了RPC的过程。比如：HTTP REST风格，Java RMI规范、WebService SOAP协议、Hession等等。</p>
</li>
<li><p>垂直架构存在的问题：</p>
<p style="text-indent: 1em;">重复功能太多</p></li>
<li><p>分布式架构存在的问题：</p>
<p style="text-indent: 1em;">服务提供方一旦产生变更，所有消费方都需要变更。</p></li>
</ul>
<ol start="4">
<li>架构演进–SOA架构<br><img src="/./img/SOA.png" alt="SOA架构"></li>
</ol>
<ul>
<li>SOA：（Service-Oriented Architecture，面向服务的架构）是一个组件模型它将应用程序的不同功能单元（称为服务）进行拆分，并通过这些服务之间定义良好的接口和契约联系起来。</li>
<li>ESB:（Enterparise Servce Bus）企业服务总线，服务中介。主要是提供了一个服务于服务之间的交互。ESB包含的功能如：负载均衡，流量控制，加密处理，服务的监控，异常处理，监控告急等等。</li>
<li>分布式架构存在的问题：<p style="text-indent: 1em;">服务提供方一旦产生变更，所有消费方都需要变更</p></li>
</ul>
<ol start="5">
<li>架构演进–微服务架构<br><img src="/./img/smallService.png" alt="微服务架构"></li>
</ol>
<ul>
<li>微服务架构是在SOA上做的升华，微服务架构强调的一个重点是“业务需要彻底的阻件化和服务化”，原有的单个业务系统会拆分为多个可以独立开发、设达、运行的小应用。这些小应用之间通过服务完成交互和集成。</li>
<li>微服务架构&#x3D;80%的SOA服务架构思想+100%的组件化架构思想+80%的领域建模思想</li>
<li>特点：<p style="text-indent: 1em;">服务实现组件化：开发者可以自由选择开发技术。也不需要协调其他团队。</p>
<p style="text-indent: 1em;">服务之间交互一般使用REST API。</p>
<p style="text-indent: 1em;">去中心化：每个微服务有自己私有的数据库持久化业务数据。</p>
<p style="text-indent: 1em;">自动化部署：把应用拆分成为一个一个独立的单个服务，方便自动化部署、测试、运维。</p></li>
</ul>
<h1 id="Dubbo概述"><a href="#Dubbo概述" class="headerlink" title="Dubbo概述"></a>Dubbo概述</h1><ul>
<li>Dubbo是阿里巴巴公司开源的一个高性能、轻量级的Java RPC框架。</li>
<li>致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理方案。<br><img src="/./img/dubboFrame.png" alt="dubbo架构"></li>
<li>节点角色说明：<br>Provider：暴露服务的服务提供方<br>Container：服务运行容器<br>Consumer：调用远程服务的服务消费方<br>Registry：服务注册与发现的注册中心<br>Monitor：统计服务的调用次数和调用时间的监控中心<h1 id="Dubbo快速入门"><a href="#Dubbo快速入门" class="headerlink" title="Dubbo快速入门"></a>Dubbo快速入门</h1></li>
</ul>
<ol>
<li>某个电商系统订单服务需要调用用户服务获取某个用户的所有地址：<br>我们现在需要创建两个服务模块进行测试。</li>
</ol>
<table>
<thead>
<tr>
<th>模块</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>订单服务模块</td>
<td>创建订单等</td>
</tr>
<tr>
<td>用户服务web模块</td>
<td>查询用户地址等</td>
</tr>
</tbody></table>
<ul>
<li>订单服务wb模块在A服务器，用户服务模块在B服务器，A可以远程调用B的功能。</li>
</ul>
<p><img src="/./img/ex1.png" alt="示例图"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">user-service-provider包下provider.xml文件</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 将服务提供者注册到注册中心</span></span><br><span class="line"><span class="comment"> *      1.导入dubbo依赖(2.6.2)操作zookeeper的客户端(curator)</span></span><br><span class="line"><span class="comment">         &lt;dependency&gt;</span></span><br><span class="line"><span class="comment">            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">            &lt;artifactId&gt;dubbo&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">            &lt;version&gt;2.6.2&lt;/version&gt;</span></span><br><span class="line"><span class="comment">        &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        注册中心使用的是zookeeper，引入操作zookeeper的客户端--&gt;</span></span><br><span class="line"><span class="comment">        &lt;dependency&gt;</span></span><br><span class="line"><span class="comment">            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">            &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">            &lt;version&gt;2.12.0&lt;/version&gt;</span></span><br><span class="line"><span class="comment">        &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment"> *      2.配置服务提供者</span></span><br><span class="line"><span class="comment"> * 让服务消费者去注册中心订阅服务提供者的服务地址</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">&lt;!--<span class="number">1.</span> 指定当前服务/应用的名字(同样是名字服务相同，不要和别的服务相同)项目名--&gt;</span><br><span class="line">    &lt;dubbo:application name=<span class="string">&quot;user-servoce-provider&quot;</span>&gt;&lt;/dubbo:application&gt;</span><br><span class="line">&lt;!--    <span class="number">2.</span> 指定注册中心的位置--&gt;</span><br><span class="line">&lt;!--    &lt;dubbo:registry address=<span class="string">&quot;zookeeper://127.0.0.1:2181&quot;</span>&gt;&lt;/dubbo:registry&gt;--&gt;</span><br><span class="line">    &lt;dubbo:registry protocol=<span class="string">&quot;zookeeper&quot;</span> address=<span class="string">&quot;127.0.0.1:2181&quot;</span>&gt;&lt;/dubbo:registry&gt;</span><br><span class="line">&lt;!--    <span class="number">3.</span> 指定通信规则(通信协议&amp;通信端口)--&gt;</span><br><span class="line">    &lt;dubbo:protocol name=<span class="string">&quot;dubbo&quot;</span> port=<span class="string">&quot;20880&quot;</span>&gt;&lt;/dubbo:protocol&gt;</span><br><span class="line">&lt;!--    <span class="number">4.</span> 暴露服务让别人调用 ref:指向服务的真正实现对象 interface:公共包gmall-interface下的接口--&gt;</span><br><span class="line">    &lt;dubbo:service interface=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> ref=<span class="string">&quot;userServiceImpl&quot;</span>&gt;&lt;/dubbo:service&gt;</span><br><span class="line">&lt;!--服务的实现--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;userServiceImpl&quot;</span> class=<span class="string">&quot;com.atguigu.gmall.service.impl.UserServiceImpl&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line">    &lt;!--链接监控中心--&gt;</span><br><span class="line">    &lt;dubbo:monitor protocol=<span class="string">&quot;registy&quot;</span>&gt;&lt;/dubbo:monitor&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">order-service-consumer包下的consumer.xml文件</span><br><span class="line">&lt;!--开启注解扫描--&gt;</span><br><span class="line">    &lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.atgugui.gmall.service.Impl&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line">&lt;dubbo:application name=<span class="string">&quot;order-service-consumer&quot;</span>&gt;&lt;/dubbo:application&gt;</span><br><span class="line">&lt;dubbo:registry address=<span class="string">&quot;zookeeper://127.0.0.1:2181&quot;</span>&gt;&lt;/dubbo:registry&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--    声明需要调用的远程服务暴露的接口--&gt;</span><br><span class="line">&lt;dubbo:reference interface=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> id=<span class="string">&quot;userService&quot;</span>&gt;&lt;/dubbo:reference&gt;</span><br><span class="line">&lt;!--链接监控中心。从注册中心发现监控中心地址--&gt;</span><br><span class="line">    &lt;dubbo:monitor protocol=<span class="string">&quot;registy&quot;</span>&gt;&lt;/dubbo:monitor&gt;</span><br><span class="line">&lt;!--    &lt;dubbo:monitor address=<span class="string">&quot;127.0.0.1:7070&quot;</span>&gt;&lt;/dubbo:monitor&gt;--&gt;</span><br></pre></td></tr></table></figure>
<h2 id="监控中心"><a href="#监控中心" class="headerlink" title="监控中心"></a>监控中心</h2><h3 id="dubbo-admin"><a href="#dubbo-admin" class="headerlink" title="dubbo-admin"></a>dubbo-admin</h3><p>图形化的服务管理页面；安装时需要指定注册中心地址，即可从注册中心中获取到所有的提供者&#x2F;消费者进行配置管理</p>
<h3 id="dubbo-monitor-simple"><a href="#dubbo-monitor-simple" class="headerlink" title="dubbo-monitor-simple"></a>dubbo-monitor-simple</h3><p> 简单的监控中心</p>
<h2 id="整合springboot"><a href="#整合springboot" class="headerlink" title="整合springboot"></a>整合springboot</h2> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  boot-user-service-provider-&gt;applicatino.xml文件下</span><br><span class="line">dubbo.application.name=user-service-provider</span><br><span class="line">dubbo.registry.address=127.0.0.1:2181</span><br><span class="line">dubbo.registry.protocol=zookeeper</span><br><span class="line"></span><br><span class="line">dubbo.protocol.name=dubbo</span><br><span class="line">dubbo.protocol.port=20881</span><br><span class="line"></span><br><span class="line">dubbo.monitor.protocol=registry</span><br><span class="line">dubbo.scan.base-packages=com.atguigu.gmall</span><br></pre></td></tr></table></figure>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> boot-user-service-provider提供者包下</span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将服务提供者注册到注册中心</span></span><br><span class="line"><span class="comment"> *      1.导入dubbo依赖(2.6.2)操作zookeeper的客户端(curator)</span></span><br><span class="line"><span class="comment"> *      2.配置服务提供者</span></span><br><span class="line"><span class="comment"> * 让服务消费者去注册中心订阅服务提供者的服务地址</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"> <span class="meta">@Service</span><span class="comment">//暴露服务 </span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;UserAddress&gt; <span class="title function_">getUserAddressList</span><span class="params">(String userId)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableDubbo</span> <span class="comment">//开启基于注解的dubbo功能</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootUserServiceProviderApplication</span> &#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">boot-order-service-consumer-&gt;applicatino.xml文件下</span><br><span class="line"></span><br><span class="line">dubbo.application.name=boot-order-service-consumer</span><br><span class="line">dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br><span class="line">dubbo.monitor.protocol=registry</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">boot-order-service-consumer消费者包下</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Reference(loadbalance=&quot;random&quot;,timeout=1000)</span> <span class="comment">//dubbo直连  远程引用服务，自己会从注册中心发现</span></span><br><span class="line">	UserService userService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableDubbo</span><span class="comment">//开启基于注解的dubbo功能</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootOrderServiceConsumerApplication</span> &#123;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="dubbo覆盖顺序"><a href="#dubbo覆盖顺序" class="headerlink" title="dubbo覆盖顺序"></a>dubbo覆盖顺序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-Ddubbo.protocol.port<span class="number">.20880</span></span><br><span class="line">xml dubbo.xml/application.properties</span><br><span class="line">dubbo dubbo.properties</span><br></pre></td></tr></table></figure>
<ul>
<li>JVM启动-D参数优先，这样可以是用户在部署和启动时进行参数重写，比如在启动时需要改变协议的端口<br>xml次之，如果在xml中有配置，则dubbo.properties中相应的配置无效</li>
</ul>
<h2 id="启动时检查"><a href="#启动时检查" class="headerlink" title="启动时检查"></a>启动时检查</h2><ul>
<li>Dubbo缺省会在启动时检查依赖的服务是否可用，不可用时会抛出异常，阻止Sprig初始化完成，以便上线时，能及早发现问题，默认check&#x3D;”true”。<br>可以通过checka&#x3D;”false”关闭检查，比如，测试时，有些服务不关心，或者出现了循环依赖，必须有一方先启动。</li>
<li>另外，如果你的Spring容器是懒加载的，或者通过API编程延迟引用服务，请关闭check，否则服务临时不可用时，会抛出异常，拿到nul引用，如果checka&#x3D;”false”，总是会返回引用，当服务恢复时，能自动连上。<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在调用时向注册中心发起检查 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:reference</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    配置当前消费者的统一规则：所有服务都不检查--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:consumer</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:consumer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="超时及配置覆盖关系"><a href="#超时及配置覆盖关系" class="headerlink" title="超时及配置覆盖关系"></a>超时及配置覆盖关系</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--     timeout=&quot;0&quot; 在消费方引用服务提供方时方法在指定时间内没有返回 就立即终止</span></span><br><span class="line"><span class="comment">          1. 精确优先（方法级优先，接口级次之，全局配置再次之）</span></span><br><span class="line"><span class="comment">          2. 消费者优先（如果级别一样，则消费方优先，提供方次之）--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:reference</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    统一设置服务提供方的规则--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dubbo:provider</span> <span class="attr">timeout</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:provider</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">dubbo:method</span> <span class="attr">name</span>=<span class="string">&quot;getUserAddressList&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:method</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="重试次数"><a href="#重试次数" class="headerlink" title="重试次数"></a>重试次数</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    幂等（设置重试次数）[查询、删除、修改]无论执行多少次和执行一次的效果是一样的</span></span><br><span class="line"><span class="comment">        非幂等（不能设置重试次数）[新增]每次运行都会产生新的效果--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;0&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:reference</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="多版本"><a href="#多版本" class="headerlink" title="多版本"></a>多版本</h2><ul>
<li>当一个接口实现，出现不兼容升级时，可以用版本号过渡，版本号不同的服务相互间不引用。<br>可以按照以下的步骤进行版本迁移：</li>
</ul>
<ol start="0">
<li>在低压力时间段，先升级一半提供者为新版本</li>
<li>再将所有消费者升级为新版本</li>
<li>然后将剩下的一半提供者升级为新版本</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">provider.xml下</span><br><span class="line"><span class="comment">&lt;!--    4. 暴露服务让别人调用 ref:指向服务的真正实现对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userServiceImpl&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0.0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userServiceImpl1&quot;</span> <span class="attr">version</span>=<span class="string">&quot;2.0.0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:service</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    consumer.xml下</span><br><span class="line">    <span class="comment">&lt;!-- version选择版本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span>  <span class="attr">version</span>=<span class="string">&quot;1.0.0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="本地存根"><a href="#本地存根" class="headerlink" title="本地存根"></a>本地存根</h2><p>远程服务后，客户端通常只剩下接口，而实现全在服务器端，但提供方有些时候想在客户端也执行部分逻辑，比如：做ThreadLocal缓存，提前验证参数，调用失败后伪造容错数据等等，此时就需要在API中带上Stub，客户端生成Proxy实例，会把Proxy通过构造函数传给Stub，然后把Stub暴露给用户，Stub可以决定要不要去调Proxy。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceStub</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> UserService userService;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 传入的是userService远程的代理对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> userService</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">UserServiceStub</span><span class="params">(UserService userService)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>();</span><br><span class="line">		<span class="built_in">this</span>.userService = userService;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;UserAddress&gt; <span class="title function_">getUserAddressList</span><span class="params">(String userId)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;UserServiceStub.....&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(!StringUtils.isEmpty(userId)) &#123;</span><br><span class="line">			<span class="keyword">return</span> userService.getUserAddressList(userId);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置本地存根--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">interface</span>=<span class="string">&quot;com.atgugui.gmall.service.UserService&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">stub</span>=<span class="string">&quot;com.atgugui.gmall.service.Impl.UserserviceStub&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:reference</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Springboot与dubbo整合的三种方式"><a href="#Springboot与dubbo整合的三种方式" class="headerlink" title="Springboot与dubbo整合的三种方式"></a>Springboot与dubbo整合的三种方式</h2><ol>
<li>导入dubbo-start,在application.properties配置属性，使用@Service[暴露服务],使用@Reference[引用服务]</li>
<li>保留dubbo.xml配置文件;<br>导入dubbo-start;使用@ImportResource导入dubbo的配置文件即可<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ImportResource(locations=&quot;classpath:provider.xml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootUserServiceProviderApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SpringApplication.run(BootUserServiceProviderApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>使用注解API的方式<br>将每一个组件手动创建到容器中，让duboo来扫描其他的组件<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDubboConfig</span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> ApplicationConfig <span class="title function_">applicationConfig</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">ApplicationConfig</span> <span class="variable">applicationConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationConfig</span>();</span><br><span class="line">		applicationConfig.setName(<span class="string">&quot;boot-user-service-provider&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> applicationConfig;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//&lt;dubbo:registry protocol=&quot;zookeeper&quot; address=&quot;127.0.0.1:2181&quot;&gt;&lt;/dubbo:registry&gt;</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> RegistryConfig <span class="title function_">registryConfig</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">RegistryConfig</span> <span class="variable">registryConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegistryConfig</span>();</span><br><span class="line">		registryConfig.setProtocol(<span class="string">&quot;zookeeper&quot;</span>);</span><br><span class="line">		registryConfig.setAddress(<span class="string">&quot;127.0.0.1:2181&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> registryConfig;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//&lt;dubbo:protocol name=&quot;dubbo&quot; port=&quot;20882&quot;&gt;&lt;/dubbo:protocol&gt;</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> ProtocolConfig <span class="title function_">protocolConfig</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">ProtocolConfig</span> <span class="variable">protocolConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProtocolConfig</span>();</span><br><span class="line">		protocolConfig.setName(<span class="string">&quot;dubbo&quot;</span>);</span><br><span class="line">		protocolConfig.setPort(<span class="number">20882</span>);</span><br><span class="line">		<span class="keyword">return</span> protocolConfig;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *&lt;dubbo:service interface=&quot;com.atguigu.gmall.service.UserService&quot; </span></span><br><span class="line"><span class="comment">		ref=&quot;userServiceImpl01&quot; timeout=&quot;1000&quot; version=&quot;1.0.0&quot;&gt;</span></span><br><span class="line"><span class="comment">		&lt;dubbo:method name=&quot;getUserAddressList&quot; timeout=&quot;1000&quot;&gt;&lt;/dubbo:method&gt;</span></span><br><span class="line"><span class="comment">	&lt;/dubbo:service&gt;</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> ServiceConfig&lt;UserService&gt; <span class="title function_">userServiceConfig</span><span class="params">(UserService userService)</span>&#123;</span><br><span class="line">		ServiceConfig&lt;UserService&gt; serviceConfig = <span class="keyword">new</span> <span class="title class_">ServiceConfig</span>&lt;&gt;();</span><br><span class="line">		serviceConfig.setInterface(UserService.class);</span><br><span class="line">		serviceConfig.setRef(userService);</span><br><span class="line">		serviceConfig.setVersion(<span class="string">&quot;1.0.0&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//配置每一个method的信息</span></span><br><span class="line">		<span class="type">MethodConfig</span> <span class="variable">methodConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MethodConfig</span>();</span><br><span class="line">		methodConfig.setName(<span class="string">&quot;getUserAddressList&quot;</span>);</span><br><span class="line">		methodConfig.setTimeout(<span class="number">1000</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将method的设置关联到service配置中</span></span><br><span class="line">		List&lt;MethodConfig&gt; methods = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		methods.add(methodConfig);</span><br><span class="line">		serviceConfig.setMethods(methods);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ProviderConfig</span></span><br><span class="line">		<span class="comment">//MonitorConfig</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> serviceConfig;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@EnableDubbo(scanBasePackages=&quot;com.atguigu.gmall&quot;)</span><span class="comment">//开启注解扫描</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootUserServiceProviderApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SpringApplication.run(BootUserServiceProviderApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="高可用"><a href="#高可用" class="headerlink" title="高可用"></a>高可用</h2><p>高可用：通过设计，减少系统不能提供服务的时间；</p>
<h3 id="zookeeper宕机与dubbo直连"><a href="#zookeeper宕机与dubbo直连" class="headerlink" title="zookeeper宕机与dubbo直连"></a>zookeeper宕机与dubbo直连</h3><p>现象：zookeeper注册中心宕机，还可以消费dubbo暴露的服务。<br>原因：<br>监控中心宕掉不影响使用，只是丢失部分采样数据数据。<br>库宕掉后，注册中心仍能通过缓存提供服务列表查询，但不能注册新服务。<br>注册中心对等集群，任意一台宕掉后，将自动切换到另一台。<br>注册中心全部宕掉后，服务提供者和服务消费者仍能通过本地缓存通讯。<br>服务提供者无状态，任意一台宕掉后，不影响使用。<br>服务提供者全部宕掉后，服务消费者应用将无法使用，并无限次重连等待服务提供者恢复。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//@Autowired</span></span><br><span class="line">	<span class="meta">@Reference(url=&quot;127.0.0.1:20880&quot;)</span> <span class="comment">//dubbo直连</span></span><br><span class="line">	UserService userService;</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h3 id="集群下dubbo负载均衡配置"><a href="#集群下dubbo负载均衡配置" class="headerlink" title="集群下dubbo负载均衡配置"></a>集群下dubbo负载均衡配置</h3><p>在集群负载均衡时，Dubbo提供了多种均衡策略，缺省为random随机调用。</p>
<h3 id="负载均衡策略"><a href="#负载均衡策略" class="headerlink" title="负载均衡策略"></a>负载均衡策略</h3><ul>
<li>Random LoadBalance<br>随机，按权重设置随机概率。<br>在一个截面上碰撞的概率高，但调用量越大分布越均匀，而且按概率使用权重后也比较均匀，有利于动态调整提供者权重。<br><img src="/./img/RandomLoadBalance.png" alt="Random LoadBalance"></li>
<li>RoundRobin LoadBalance<br>轮循，按公约后的权重设置轮循比率。<br>存在慢的提供者累积请求的问题，比如：第二台机器很慢，但没挂，当请求调到第二台时就卡在那，久而久之，所有请求都卡在调到第二台上。<br><img src="/./img/RoundRobinLoadBalance.png" alt="RoundRobin LoadBalance"></li>
<li>LeastActive LoadBalance.<br>最少活跃调用数，相同活跃数的随机，活跃数指调用前后计数差。<br>使慢的提供者收到更少请求，因为越慢的提供者的调用前后计数差会越大。<br><img src="/./img/LeastActiveLoadBalance.png" alt="LeastActive LoadBalance"></li>
<li>ConsistentHash LoadBalance.<br>一致性Hash，相同参数的请求总是发到同一提供者。<br>当某一台提供者挂时，原本发往该提供者的请求，基于虚拟节点，平摊到其它提供者，不会引起剧烈变动。算法参见：http:&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Consistent_.hashing缺省只对第一个参数Hash，如果要修改，请配置&lt;dubbo:parameter key&#x3D;-“hash.arguments”<br>value&#x3D;”0,1&#x2F;&gt;<br>缺省用160份虚拟节点，如果要修改，请配置&lt;dubbo:parameter key&#x3D;”hash.nodes”value&#x3D;”320”&#x2F;&gt;e<br><img src="/./img/ConsistentHashLoadBalance.png" alt="ConsistentHash LoadBalance."></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//@Autowired</span></span><br><span class="line">	<span class="meta">@Reference(loadbalance=&quot;random&quot;,timeout=1000)</span> <span class="comment">//dubbo直连</span></span><br></pre></td></tr></table></figure>

<h3 id="服务降级"><a href="#服务降级" class="headerlink" title="服务降级"></a>服务降级</h3><ul>
<li><p>什么是服务降级？<br>当服务器压力剧增的情况下，根据实际业务情况及流量，对一些服务和页面有策略的不处理或换种简单的方式处理，从而释放服务器资源以保证核心交易正常运作或高效运作。<br>可以通过服务降级功能临时屏蔽某个出错的非关键服务，并定义降级后的返回策略。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 向注册中心写入动态覆盖规则 --&gt;</span></span><br><span class="line">RegistryFactory registryFactory = </span><br><span class="line">ExtensionLoader.getExtensionLoader（RegistryFactory.class）.getAdaptiveExtension（）；</span><br><span class="line">Registry registry = registryFactory.getRegistry（URL.valueOf（&quot;zookeeper://10.20.153.10:2181&quot;））；</span><br><span class="line">registry.register（URL.valueOf（&quot;override://0.0.0.0/com.foo.BarService？category=configurators&amp;dynami=false&amp;application=foo&amp;mock=force:return+null&quot;））；</span><br></pre></td></tr></table></figure></li>
<li><p>mock&#x3D;force:return+null表示消费方对该服务的方法调用都直接返回null值，不发起远程调用。用来屏蔽不重要服务不可用时对调用方的影响。</p>
</li>
<li><p>还可以改为mock&#x3D;fail:return+null表示消费方对该服务的方法调用在失败后，再返回nul值，不抛异常。用来容忍不重要服务不稳定时对调用方的影响。</p>
<h3 id="集群容错"><a href="#集群容错" class="headerlink" title="集群容错"></a>集群容错</h3></li>
<li><p>在集群调用失败时，Dubbo提供了多种容错方案，缺省为failover重试<br>集群容错模式</p>
</li>
<li><p>Failfast Cluster快速失败，只发起一次调用，失败立即报错。通常用于非幂等性的写操作，比如新增记录</p>
</li>
<li><p>Failsafe Cluster失败安全，出现异常时，直接忽略。通常用于写入审计日志等操作。</p>
</li>
<li><p>Failback Cluster失败自动恢复，后台记录失败请求，定时重发。通常用于消息通知操作。</p>
</li>
<li><p>Forking Cluster并行调用多个服务器，只要一个成功即返回。通常用于实时性要求较高的读操作，但需要浪费更多服务资源。可通过forks&#x3D;-“2”来设置最大并行数。</p>
</li>
<li><p>Broadcast Cluster广播调用所有提供者，逐个调用，任意一台报错则报错【2】。通常用于通知所有提供者更新缓存或日志等本地资源信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableHystrix</span> <span class="comment">//开启服务容错</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootUserServiceProviderApplication</span> &#123;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">provider下</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@HystrixCommand</span><span class="comment">//出现异常进行容错</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;UserAddress&gt; <span class="title function_">getUserAddressList</span><span class="params">(String userId)</span> &#123;</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">consumer下</span><br><span class="line"><span class="meta">@HystrixCommand(fallbackMethod=&quot;hello&quot;)</span><span class="comment">//出错就会执行hello方法</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> List&lt;UserAddress&gt; <span class="title function_">initOrder</span><span class="params">(String userId)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;用户id：&quot;</span>+userId);</span><br><span class="line">		<span class="comment">//1、查询用户的收货地址</span></span><br><span class="line">		List&lt;UserAddress&gt; addressList = userService.getUserAddressList(userId);</span><br><span class="line">		<span class="keyword">return</span> addressList;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> List&lt;UserAddress&gt; <span class="title function_">hello</span><span class="params">(String userId)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">	</span><br><span class="line">		<span class="keyword">return</span> Arrays.asList(<span class="keyword">new</span> <span class="title class_">UserAddress</span>(<span class="number">10</span>, <span class="string">&quot;测试地址&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;测试&quot;</span>, <span class="string">&quot;测试&quot;</span>, <span class="string">&quot;Y&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="RPC原理"><a href="#RPC原理" class="headerlink" title="RPC原理"></a>RPC原理</h2><ul>
<li>一次完整的RPC调用流程（同步调用，异步另说）如下：<br>1）服务消费方（client）调用以本地调用方式调用服务；<br>2）client stub接收到调用后负责将方法、参数等组装成能够进行网络传输的消，息体；<br>3）client stub找到服务地址，并将消息发送到服务端；<br>4）server stub收到消息后进行解码；<br>5）server stub根据解码结果调用本地的服务；<br>6）本地服务执行并将结果返回给server stub；<br>7）server stub将返回结果打包成消息并发送至消费方；+<br>8）client stub接收到消息，并进行解码；<br>9）服务消费方得到最终结果。<br>RPC框架的目标就是要2~8这些步骤都封装起来，这些细节对用户来说是透明的，不可见的。</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小不牛</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/03/09/dubbo/dubbo/">http://example.com/2022/03/09/dubbo/dubbo/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">小不牛</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/./img/dubbo.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/03/08/hello-world/"><img class="next-cover" src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hello World</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">小不牛</div><div class="author-info__description">Welcome to xiaobuniu's blog</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/constown" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/blog.juanertu.com" target="_blank" title="博客"><i class="fab fa-algolia"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到小不牛的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">分布式系统中相关概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E5%9E%8B%E4%BA%92%E8%81%94%E7%BD%91%E6%9E%B6%E6%9E%84%E7%9B%AE%E6%A0%87"><span class="toc-number">1.1.</span> <span class="toc-text">大型互联网架构目标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E9%A1%B9%E7%9B%AE%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">传统项目和互联网项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%92%8C%E5%88%86%E5%B8%83%E5%BC%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">集群和分布式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E5%92%8C%E6%BC%94%E8%BF%9B"><span class="toc-number">1.1.3.</span> <span class="toc-text">架构和演进</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dubbo%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">Dubbo概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dubbo%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">3.</span> <span class="toc-text">Dubbo快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%91%E6%8E%A7%E4%B8%AD%E5%BF%83"><span class="toc-number">3.1.</span> <span class="toc-text">监控中心</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dubbo-admin"><span class="toc-number">3.1.1.</span> <span class="toc-text">dubbo-admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dubbo-monitor-simple"><span class="toc-number">3.1.2.</span> <span class="toc-text">dubbo-monitor-simple</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E5%90%88springboot"><span class="toc-number">3.2.</span> <span class="toc-text">整合springboot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dubbo%E8%A6%86%E7%9B%96%E9%A1%BA%E5%BA%8F"><span class="toc-number">3.3.</span> <span class="toc-text">dubbo覆盖顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%97%B6%E6%A3%80%E6%9F%A5"><span class="toc-number">3.4.</span> <span class="toc-text">启动时检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E5%8F%8A%E9%85%8D%E7%BD%AE%E8%A6%86%E7%9B%96%E5%85%B3%E7%B3%BB"><span class="toc-number">3.5.</span> <span class="toc-text">超时及配置覆盖关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E8%AF%95%E6%AC%A1%E6%95%B0"><span class="toc-number">3.6.</span> <span class="toc-text">重试次数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%89%88%E6%9C%AC"><span class="toc-number">3.7.</span> <span class="toc-text">多版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E6%A0%B9"><span class="toc-number">3.8.</span> <span class="toc-text">本地存根</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Springboot%E4%B8%8Edubbo%E6%95%B4%E5%90%88%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.9.</span> <span class="toc-text">Springboot与dubbo整合的三种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E5%8F%AF%E7%94%A8"><span class="toc-number">3.10.</span> <span class="toc-text">高可用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper%E5%AE%95%E6%9C%BA%E4%B8%8Edubbo%E7%9B%B4%E8%BF%9E"><span class="toc-number">3.10.1.</span> <span class="toc-text">zookeeper宕机与dubbo直连</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E4%B8%8Bdubbo%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%85%8D%E7%BD%AE"><span class="toc-number">3.10.2.</span> <span class="toc-text">集群下dubbo负载均衡配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5"><span class="toc-number">3.10.3.</span> <span class="toc-text">负载均衡策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7"><span class="toc-number">3.10.4.</span> <span class="toc-text">服务降级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%AE%B9%E9%94%99"><span class="toc-number">3.10.5.</span> <span class="toc-text">集群容错</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RPC%E5%8E%9F%E7%90%86"><span class="toc-number">3.11.</span> <span class="toc-text">RPC原理</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/09/dubbo/dubbo/" title="dubbo"><img src="/./img/dubbo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="dubbo"/></a><div class="content"><a class="title" href="/2022/03/09/dubbo/dubbo/" title="dubbo">dubbo</a><time datetime="2022-03-09T04:07:15.232Z" title="发表于 2022-03-09 12:07:15">2022-03-09</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2022/03/08/hello-world/" title="Hello World">Hello World</a><time datetime="2022-03-08T08:22:37.934Z" title="发表于 2022-03-08 16:22:37">2022-03-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 小不牛</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi,welcome to my blog</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>